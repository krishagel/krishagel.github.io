---
layout: post
title: Google Apps Directory Sync - Specific Group/OU Selection
date: '2010-02-04T17:42:00.000-08:00'
author: Kris Hagel
tags:
- Google Apps
- Howto
- LDAP
modified_time: '2010-02-04T17:54:55.415-08:00'
thumbnail: http://1.bp.blogspot.com/_BBmDIqRhYWw/S2twoKIaLfI/AAAAAAAAAz8/caJbUxC7ops/s72-c/Screen%20shot%202010-02-04%20at%205.00.29%20PM.png
blogger_id: tag:blogger.com,1999:blog-3730747668829960203.post-1011421779654266190
blogger_orig_url: http://blog.krishagel.com/2010/02/google-apps-directory-sync-specific.html
---

Over the past year people have asked me how they can go about deploying Google Apps in their organization, and how they can do it on a limited basis at first. &nbsp;That answer is a bit more complex than I want to tackle today, but in the last few days I had a colleague in a local school district ask how he could deploy a few accounts while still using GADS. &nbsp;That is something I will tackle today, if you would like to follow along, I would hope you have some experience (at least installing) <a href="http://www.google.com/support/a/bin/answer.py?hl=en&amp;answer=106368">Google Apps Directory Sync</a>.<br /><br />The situation here is the following, my colleague wanted to create a group in Active Directory, and then when specific users needed to have accounts in Google Apps, he would just drop them into there, and the next run of GADS will create the accounts in Google Apps. &nbsp;I knew this could be done, but had never done it, so here without further ado is what is necessary. &nbsp;After the break you will find the entire instructions for successfully setting this up.<br /><br /><br /><a name='more'></a><br /><br />Below you will see the standard interface for GADS, if you have not done anything else, you will need to setup the connection to your LDAP (Active Directory here) server, and of course your Google Apps administrator account for your domain.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_BBmDIqRhYWw/S2twoKIaLfI/AAAAAAAAAz8/caJbUxC7ops/s1600-h/Screen%20shot%202010-02-04%20at%205.00.29%20PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="238" src="http://1.bp.blogspot.com/_BBmDIqRhYWw/S2twoKIaLfI/AAAAAAAAAz8/caJbUxC7ops/s400/Screen%20shot%202010-02-04%20at%205.00.29%20PM.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">Once you have your connections correct (you can use the test connection button to test this), you can step through the wizard to get yourself to the user sync section which by default looks like below:</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_BBmDIqRhYWw/S2txVwfGWFI/AAAAAAAAA0A/aQYC0fjMn98/s1600-h/Screen%20shot%202010-02-04%20at%205.15.10%20PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="240" src="http://4.bp.blogspot.com/_BBmDIqRhYWw/S2txVwfGWFI/AAAAAAAAA0A/aQYC0fjMn98/s400/Screen%20shot%202010-02-04%20at%205.15.10%20PM.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">From here you have a couple of options, and they all depend on how you are going to organize your users in Active Directory. &nbsp;I will show two methods here: one if you had already created an OU with these users you wanted to sync, and another which is what my colleague was looking for and that is if you have created a specific group.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">To setup the user sync rules in the above screen takes some minor knowledge of LDAP queries and how&nbsp;your directory is structured. &nbsp;If you have no knowledge of LDAP queries, I will give you what you need to enter to achieve the desired result. &nbsp;The first thing you need to do in either case is to find the group or OU that you want to select and know how to find this using LDAP queries. &nbsp;Below you will see the standard interface of the Active Directory Users and Computers tool. &nbsp;Here you can move through the tree of your directory and navigate to where you want to be. &nbsp;You will need to remember what you need to do to get to this location again in the tree structure of your directory.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_BBmDIqRhYWw/S2tzHN42KLI/AAAAAAAAA0E/-3EzVfSCFEQ/s1600-h/Screen%20shot%202010-02-04%20at%2010.57.24%20AM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="285" src="http://2.bp.blogspot.com/_BBmDIqRhYWw/S2tzHN42KLI/AAAAAAAAA0E/-3EzVfSCFEQ/s400/Screen%20shot%202010-02-04%20at%2010.57.24%20AM.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">Below is a screen shot from&nbsp;<a href="http://www.ldapadministrator.com/download.htm">Softerra LDAP Browser 2.6</a>, a free program I downloaded which will allow you to browse the entire LDAP structure, not just what you can see in AD U&amp;C. &nbsp;There are many programs that will do this, but this is one I found to easily provide the information I need.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_BBmDIqRhYWw/S2tzxmAPBUI/AAAAAAAAA0I/jV1xfI9KqSY/s1600-h/Screen%20shot%202010-02-04%20at%205.02.22%20PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="235" src="http://4.bp.blogspot.com/_BBmDIqRhYWw/S2tzxmAPBUI/AAAAAAAAA0I/jV1xfI9KqSY/s400/Screen%20shot%202010-02-04%20at%205.02.22%20PM.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">You will see the left hand pane is much like AD U&amp;C, but it is the raw LDAP data, you will need to browse through your directory to get to exactly where your group or OU exists. &nbsp;Once you have that highlighted, you have all the information you need from LDAP up in the title bar of the application which is the LDAP address of what you are looking for. &nbsp;It will appear in a format such as this: OU=Example,DC=YOUR,DC=DOMAIN,DC=HERE. &nbsp;I won't go into explaining that today, but just know there is a lot more behind that.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Once you have your LDAP information, we can go back to the configuration manager tool for GADS, and enter that information in. &nbsp;Below is the screen for creating a rule to include an entire OU:</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_BBmDIqRhYWw/S2t1O6X4w9I/AAAAAAAAA0M/2I-2yVnp4AI/s1600-h/Screen%20shot%202010-02-04%20at%205.11.54%20PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="335" src="http://4.bp.blogspot.com/_BBmDIqRhYWw/S2t1O6X4w9I/AAAAAAAAA0M/2I-2yVnp4AI/s400/Screen%20shot%202010-02-04%20at%205.11.54%20PM.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">In a typical rule window you need to create the filter (what information you want) and where it is located. &nbsp;For this rule above, we want to select all users, hence the objectclass=user in the rule section, and then in the Base DN section, that is where you will enter the location of your OU that we found in the previous step. &nbsp;Once you enter these two simple things, you will then include just that OU of users into GA.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Now moving onto creating a rule for an entire group, this process is much like the above step but we will use the default Base DN that you setup earlier, and not fill anything in there, and all the configuration will exist in the rules section.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_BBmDIqRhYWw/S2t2EBS_CZI/AAAAAAAAA0Q/nCosULJTkRY/s1600-h/Screen%20shot%202010-02-04%20at%205.12.03%20PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="348" src="http://2.bp.blogspot.com/_BBmDIqRhYWw/S2t2EBS_CZI/AAAAAAAAA0Q/nCosULJTkRY/s400/Screen%20shot%202010-02-04%20at%205.12.03%20PM.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">You will see above that the rule is much more complicated but I add it below and show you what you need to change:</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><b>LDAP Query:</b></div><div class="separator" style="clear: both; text-align: left;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">(&amp;(objectCategory=person)(|(objectClass=contact)(objectClass=user))(memberOf=CN=3056_AA_1st_Grade,OU=Students,OU=VES,OU=PSD,DC=Peninsula,DC=wednet,DC=edu))</span></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">In this entire line the part you need to change out is the section after memberOf= and ending with edu, and you will change that out with your group that you located using the LDAP Browser above.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">The rest simply queries that they only want users who are real persons that are a member of the group listed.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">That is all that is necessary to setup GADS to sync only specific entries in your LDAP directory. &nbsp;It seems to be a bit complicated when first looking into it, but with the help of a couple of Google searches and the above article, I hope you can get it figured out. &nbsp;If you have any questions, please let me know and I will do the best I can to help you.</div>