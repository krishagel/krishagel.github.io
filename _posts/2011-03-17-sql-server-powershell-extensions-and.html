---
layout: post
title: SQL Server PowerShell Extensions and MySQL
date: '2011-03-17T19:43:00.001-07:00'
author: Kris
tags:
- SQL
- PowerShell
modified_time: '2011-03-17T20:00:08.760-07:00'
blogger_id: tag:blogger.com,1999:blog-3730747668829960203.post-2793774862012223630
blogger_orig_url: http://blog.krishagel.com/2011/03/sql-server-powershell-extensions-and.html
---

<div><span class="Apple-style-span">For quite a while now I have been looking for an easy way to use MySQL databases with PowerShell.  Everything I had read and found about it earlier made it seem like quite a hassle.  All of that seems to have changed for me today when I found the latest release of the <a href="http://sqlpsx.codeplex.com/">SQLPSX</a> included a mysql module as well as the SQL Server and Oracle modules they had previously had.</span></div><div><span class="Apple-style-span"><br /></span></div><div><span class="Apple-style-span">Well, I dug right in and figured out what was necessary to get this running.  With a little assistance from <a href="http://technet.microsoft.com/en-us/library/ee176848.aspx">get-help</a> and some previous knowledge of I was able to get a sample script up and running.  Note that beyond installing SQLPSX, you will also need to install the <a href="http://dev.mysql.com/downloads/connector/net/">MySQL Connector/Net</a> to provide the .NET bindings that this module needs.</span></div><div><span class="Apple-style-span"><br /></span></div><div><span class="Apple-style-span">Below you will see some sample PowerShell code that I got working.  It just simply connects to the server and queries the user table, and spitting it out.  Of course this is just a proof of concept, you can see</span></div><div><div><br /></div><div><span class="Apple-style-span" style="font-family: monospace; font-size: 13px; white-space: pre; "><span style="color: #008000;">#</span><span style="color: #008000;"> simple script to test the new mysql module in sqlpsx</span><span style="color: #008000;"> </span></span><span class="Apple-style-span" style="font-family: monospace; font-size: 13px; white-space: pre; "> </span></div><div><pre><span style="color: #800080;">$server</span><span style="color: #000000;"> </span><span style="color: #FF0000;">=</span><span style="color: #000000;"> </span><span style="color: #800000;">'</span><span style="color: #800000;">servername</span><span style="color: #800000;">'</span><span style="color: #000000;"><br /></span><span style="color: #800080;">$user</span><span style="color: #000000;"> </span><span style="color: #FF0000;">=</span><span style="color: #000000;"> </span><span style="color: #800000;">'</span><span style="color: #800000;">dbuser</span><span style="color: #800000;">'</span><span style="color: #000000;"><br /></span><span style="color: #800080;">$pass</span><span style="color: #000000;"> </span><span style="color: #FF0000;">=</span><span style="color: #000000;"> </span><span style="color: #800000;">'</span><span style="color: #800000;">dbpass</span><span style="color: #800000;">'</span><span style="color: #000000;"><br /></span><span style="color: #800080;">$database</span><span style="color: #000000;"> </span><span style="color: #FF0000;">=</span><span style="color: #000000;"> </span><span style="color: #800000;">'</span><span style="color: #800000;">databasename</span><span style="color: #800000;">'</span><span style="color: #000000;"><br /><br /></span><span style="color: #5F9EA0; font-weight: bold;">Import-Module</span><span style="color: #000000;"> </span><span style="color: #800000;">mysqllib</span><span style="color: #000000;"><br /><br /></span><span style="color: #800080;">$conn</span><span style="color: #000000;"> </span><span style="color: #FF0000;">=</span><span style="color: #000000;"> </span><span style="color: #5F9EA0;">New-MySQLConnection</span><span style="color: #000000;"> </span><span style="color: #5F9EA0; font-style: italic;">-server</span><span style="color: #000000;"> </span><span style="color: #800080;">$server</span><span style="color: #000000;"> </span><span style="color: #5F9EA0; font-style: italic;">-user</span><span style="color: #000000;"> </span><span style="color: #800080;">$user</span><span style="color: #000000;"> </span><span style="color: #5F9EA0; font-style: italic;">-password</span><span style="color: #000000;"> </span><span style="color: #800080;">$pass</span><span style="color: #000000;"> </span><span style="color: #5F9EA0; font-style: italic;">-database</span><span style="color: #000000;"> </span><span style="color: #800080;">$database</span><span style="color: #000000;"><br /><br /></span><span style="color: #800080;">$res</span><span style="color: #000000;"> </span><span style="color: #FF0000;">=</span><span style="color: #000000;"> </span><span style="color: #5F9EA0;">Invoke-MySQLQuery</span><span style="color: #000000;"> </span><span style="color: #800000;">"</span><span style="color: #800000;">select * from user</span><span style="color: #800000;">"</span><span style="color: #000000;"> -conn </span><span style="color: #800080;">$conn</span><span style="color: #000000;"><br /><br /></span><span style="color: #0000FF;">foreach</span><span style="color: #000000;"> (</span><span style="color: #800080;">$line</span><span style="color: #000000;"> </span><span style="color: #0000FF;">in</span><span style="color: #000000;"> </span><span style="color: #800080;">$res</span><span style="color: #000000;">) {<br />  </span><span style="color: #5F9EA0; font-weight: bold;">Write-Host</span><span style="color: #000000;"> </span><span style="color: #800080;">$line</span><span style="color: #000000;">.</span><span style="color: #8B4513;">User</span><span style="color: #000000;"><br />}</span></pre>Of course this is just a proof of concept, but you can see the simplicity of how this can be used.  Hopefully in the future, I will have time to show some greater use of this new found tech.</div></div>